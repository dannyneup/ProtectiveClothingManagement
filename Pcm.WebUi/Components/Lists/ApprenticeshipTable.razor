@using Pcm.Infrastructure.Entities
@using Pcm.Infrastructure.ResponseModels
<MudDialog bind-IsVisible="true">
    <DialogContent>
        <ApprenticeshipDetails Apprentices="_selectedApprenticeshipResponseModel.Apprentices"/>
    </DialogContent>
</MudDialog>

<MudTable T="ApprenticeshipResponseModel" Items="_apprenticeships" Hover="true" SortLabel="Sort By"
          Filter="new Func<ApprenticeshipResponseModel, bool>(ApprenticeshipFilter)"
          OnRowClick="OnRowClick">
    <ToolBarContent>
        <MudText Color="Color.Primary" Typo="Typo.h6">@Localization.apprenticeships</MudText>
        <MudSpacer/>
        <MudTextField T="string" Placeholder="@Localization.search"
                      Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" @bind-Value="_searchString"/>
        <MudIconButton Icon="@Icons.Filled.AddBox" @onclick="(()=>_showDialog = !_showDialog)"/>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<ApprenticeshipResponseModel, object>(x => x.Name)">@Localization.apprenticeship</MudTableSortLabel>
        </MudTh>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<ApprenticeshipResponseModel, object>(x => x.Type)">@Localization.type</MudTableSortLabel>
        </MudTh>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<ApprenticeshipResponseModel, object>(x => x.Apprentices.Count())">@Localization.apprentices</MudTableSortLabel>
        </MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="@Localization.name">@context.Name</MudTd>
        <MudTd DataLabel="@Localization.type">@context.Type</MudTd>
        <MudTd DataLabel="@Localization.apprentices">@context.Apprentices.Count()</MudTd>
    </RowTemplate>
</MudTable>

<NoTitleDialog IsVisible="_detailPopupIsOpen" Options="new DialogOptions(){MaxWidth = MaxWidth.ExtraLarge}">
    <Component>
        <ApprenticeshipDetails Apprentices="_selectedApprenticeshipResponseModel.Apprentices" Height="40vw" FixedHeader="true"/>
    </Component>
</NoTitleDialog>