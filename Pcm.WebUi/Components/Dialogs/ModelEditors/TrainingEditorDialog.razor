@using Microsoft.AspNetCore.Components
@using Pcm.Infrastructure.ResponseModels
<MudDialog>
    <DialogContent>
        <MudForm @bind-IsValid="@success">
            <MudGrid Justify="Justify.FlexStart">
                <MudItem xs="6">
                    <MudTextField T="string" 
                                  Label="@Localization.name" 
                                  @bind-Value="Training.Name"
                                  Required="true"/>
                    <TrainingTypeAutocomplete @bind-Value="Training.Type"
                                              Required="true"/>
                </MudItem>
                <MudItem xs="6">
                    <MudCard>
                        <MudCardHeader>
                            <MudText Typo="Typo.h6"
                                     Color="Color.Primary">
                                @Localization.defaultLoadout
                            </MudText>
                            <MudSpacer/>
                            <MudTextField T="string" 
                                          Placeholder="@Localization.search"
                                          Adornment="Adornment.Start" 
                                          AdornmentIcon="@Icons.Material.Filled.Search"
                                          IconSize="Size.Medium" 
                                          @bind-Value="_searchString"
                                          Class="searchTextField"/>
                        </MudCardHeader>
                        <MudTable T="ItemCategoryResponse" 
                                  Items="_itemCategories" 
                                  Hover="true" 
                                  SortLabel="Sort By"
                                  Filter="ItemCategoryFilter"
                                  Elevation="0"
                                  Dense="true"
                                  Context="itemCategory">
                            <HeaderContent>
                                <MudTh>
                                    <MudTableSortLabel 
                                        SortBy="new Func<ItemCategoryResponse, object>
                                        (x => x.Name)">@Localization.itemCategory
                                        </MudTableSortLabel>
                                </MudTh>
                                <MudTh>@Localization.count</MudTh>
                            </HeaderContent>
                            <RowTemplate>
                                <MudTd DataLabel="@Localization.itemCategory">@itemCategory.Name</MudTd>
                                <MudTd>
                                    <MudNumericField T="int" Label="@Localization.count"
                                                     Value="getItemCount(itemCategory)"
                                                    />
                                </MudTd>
                            </RowTemplate>
                        </MudTable>
                    </MudCard>
                </MudItem>
            </MudGrid>
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" Variant="Variant.Outlined" Color="Color.Secondary">@Localization.cancel</MudButton>
        <MudButton OnClick="Submit" Disabled="@(!success)" Variant="Variant.Filled" Color="Color.Primary">@Localization.save</MudButton>
    </DialogActions>
</MudDialog>